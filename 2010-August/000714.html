<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MSEide-MSEgui-talk] If &quot;tmbufdataset.Locate&quot; correct for multiple	fileds ?
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mseide-msegui-talk/2010-August/index.html" >
   <LINK REL="made" HREF="mailto:mseide-msegui-talk%40lists.berlios.de?Subject=Re%3A%20%5BMSEide-MSEgui-talk%5D%20If%20%22tmbufdataset.Locate%22%20correct%20for%20multiple%0A%09fileds%20%3F&In-Reply-To=%3Cmu5s66ttberu951649ukgfrgenogmqhr7o%404ax.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000709.html">
   <LINK REL="Next"  HREF="000715.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MSEide-MSEgui-talk] If &quot;tmbufdataset.Locate&quot; correct for multiple	fileds ?</H1>
    <B>Ivanko B</B> 
    <A HREF="mailto:mseide-msegui-talk%40lists.berlios.de?Subject=Re%3A%20%5BMSEide-MSEgui-talk%5D%20If%20%22tmbufdataset.Locate%22%20correct%20for%20multiple%0A%09fileds%20%3F&In-Reply-To=%3Cmu5s66ttberu951649ukgfrgenogmqhr7o%404ax.com%3E"
       TITLE="[MSEide-MSEgui-talk] If &quot;tmbufdataset.Locate&quot; correct for multiple	fileds ?">ivankob4mse2 at gmail.com
       </A><BR>
    <I>Fri Aug 20 07:53:23 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000709.html">[MSEide-MSEgui-talk] globally more visible active tab
</A></li>
        <LI>Next message: <A HREF="000715.html">[MSEide-MSEgui-talk] If &quot;tmbufdataset.Locate&quot; correct for	multiple fileds ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#714">[ date ]</a>
              <a href="thread.html#714">[ thread ]</a>
              <a href="subject.html#714">[ subject ]</a>
              <a href="author.html#714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;  the declaration invites  to use multiple key fileds 

Function tmbufdataset.Locate(const KeyFields: string; const KeyValues:
Variant; options: TLocateOptions) : boolean;

  function CompareText0(substr, astr: pchar; len : integer; options:
TLocateOptions): integer;

  var
    i : integer; Chr1, Chr2: byte;
  begin
    result := 0;
    i := 0;
    chr1 := 1;
    while (result=0) and (i&lt;len) and (chr1 &lt;&gt; 0) do
      begin
      Chr1 := byte(substr[i]);
      Chr2 := byte(astr[i]);
      inc(i);
      if loCaseInsensitive in options then
        begin
        if Chr1 in [97..122] then
          dec(Chr1,32);
        if Chr2 in [97..122] then
          dec(Chr2,32);
        end;
      result := Chr1 - Chr2;
      end;
    if (result &lt;&gt; 0) and (chr1 = 0) and (loPartialKey in options) then
result := 0;
  end;


var keyfield    : TField;     // Field to search in
    ValueBuffer : pchar;      // Pointer to value to search for, in
TField' internal format
    VBLength    : integer;

    FieldBufPos : PtrInt;     // Amount to add to the record buffer to
get the FieldBuffer
    CurrLinkItem: PBufRecLinkItem;
    CurrBuff    : pchar;
    bm          : TBufBookmark;

    CheckNull   : Boolean;
    SaveState   : TDataSetState;

begin
// For now it is only possible to search in one field at the same time
  result := False;

  if IsEmpty then exit;

// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; sindle field here

  keyfield := FieldByName(keyfields);
  CheckNull := VarIsNull(KeyValues);

  if not CheckNull then
    begin
    SaveState := State;
    SetTempState(dsFilter);

// &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; and single value here too
    keyfield.Value := KeyValues;

    RestoreState(SaveState);

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000709.html">[MSEide-MSEgui-talk] globally more visible active tab
</A></li>
	<LI>Next message: <A HREF="000715.html">[MSEide-MSEgui-talk] If &quot;tmbufdataset.Locate&quot; correct for	multiple fileds ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#714">[ date ]</a>
              <a href="thread.html#714">[ thread ]</a>
              <a href="subject.html#714">[ subject ]</a>
              <a href="author.html#714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mseide-msegui-talk">More information about the MSEide-MSEgui-talk
mailing list</a><br>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mseide-msegui-talk/2010-June/index.html" >
   <LINK REL="made" HREF="mailto:mseide-msegui-talk%40lists.berlios.de?Subject=Re%3A%20%5BMSEide-MSEgui-talk%5D%20about%20WM_IME_COMPOSITION%20or%20wm_ime_char&In-Reply-To=%3Ci01l9s%24605%241%40dough.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000201.html">
   <LINK REL="Next"  HREF="000207.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char</H1>
    <B>Martin Schreiber</B> 
    <A HREF="mailto:mseide-msegui-talk%40lists.berlios.de?Subject=Re%3A%20%5BMSEide-MSEgui-talk%5D%20about%20WM_IME_COMPOSITION%20or%20wm_ime_char&In-Reply-To=%3Ci01l9s%24605%241%40dough.gmane.org%3E"
       TITLE="[MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char">mse00000 at gmail.com
       </A><BR>
    <I>Fri Jun 25 09:20:30 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000201.html">[MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char
</A></li>
        <LI>Next message: <A HREF="000207.html">[MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#204">[ date ]</a>
              <a href="thread.html#204">[ thread ]</a>
              <a href="subject.html#204">[ subject ]</a>
              <a href="author.html#204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>liuzg2 wrote:

Does it work with the supported Windows versions (95/98,NT,2000,XP...) and
without East Asian language support?

&gt;<i> WM_IME_STARTCOMPOSITION:begin
</I>&gt;<i> 
</I><A HREF="http://msdn.microsoft.com/en-us/library/dd374143%28VS.85%29.aspx">http://msdn.microsoft.com/en-us/library/dd374143%28VS.85%29.aspx</A>
Minimum supported client Windows 2000 Professional

&gt;<i> po1.x:=application.caret.pos.x +application.activewidget.bounds_x ;
</I>
Warning: application.activewidget can be NIL.

&gt;<i> po1.y:= application.activewidget.bounds_cy+
</I>&gt;<i> application.activewidget.bounds_y;
</I>&gt;<i> 
</I>What happens if there is no space left below the widget and the bottom
screen edge?
 
&gt;<i> Imc:=ImmGetContext(sysevent.hwnd);
</I>
<A HREF="http://msdn.microsoft.com/en-us/library/dd318558%28VS.85%29.aspx">http://msdn.microsoft.com/en-us/library/dd318558%28VS.85%29.aspx</A>
Minimum supported client Windows XP
Version East Asian language support installed.

&gt;<i> CompositionForm.dwStyle := CFS_POINT;
</I>&gt;<i> CompositionForm.ptCurrentPos.x :=po1.x ;
</I>&gt;<i> CompositionForm.ptCurrentPos.y := po1.y;
</I>&gt;<i> ImmSetCompositionWindow(Imc, @CompositionForm);
</I>
<A HREF="http://msdn.microsoft.com/en-us/library/dd318581%28VS.85%29.aspx">http://msdn.microsoft.com/en-us/library/dd318581%28VS.85%29.aspx</A>
Minimum supported client Windows XP
Version East Asian language support installed.

&gt;<i> ImmReleaseContext(sysevent.hwnd,Imc);
</I><A HREF="http://msdn.microsoft.com/en-us/library/dd318576%28VS.85%29.aspx">http://msdn.microsoft.com/en-us/library/dd318576%28VS.85%29.aspx</A>
Minimum supported client Windows XP
Version East Asian language support installed.

Because the above functions are in Imm32.lib which probably is not available
on all Windows versions the functions must be linked by loadlibrary() and
getprocedureaddress() or MSEgui applications can't start on Windows
versions without Imm32.lib.
I'll have a look.

Martin


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000201.html">[MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char
</A></li>
	<LI>Next message: <A HREF="000207.html">[MSEide-MSEgui-talk] about WM_IME_COMPOSITION or wm_ime_char
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#204">[ date ]</a>
              <a href="thread.html#204">[ thread ]</a>
              <a href="subject.html#204">[ subject ]</a>
              <a href="author.html#204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mseide-msegui-talk">More information about the MSEide-MSEgui-talk
mailing list</a><br>
</body></html>
